---
layout : article
title : 约瑟夫问题
category : 数学
tag :
    - 具体数学
    - 约瑟夫
---

约瑟夫问题已经很常见了,是由历史学家夫拉维.约瑟夫命名的古老问题,大致是有许多人围成圈,顺时针数数,逢三就自杀,最后剩下两个人得救,约瑟夫和他的小伙伴不想无谓自杀,于是迅速计算出他们应该待的位子.

现在我们将这个问题稍微变化下,从围成圈的$n$个人开始数数,每隔一个就删去一个人,知道只有一个人幸存下来,$n = 10$的情况下,依次删去$2,4,6,8,10,3,5,7,1,9$,最后剩下原来的$5$号.记$J(n)$表示$n$个人能够幸存的原始编号,有$J(10) = 5$.

考虑$2n$个人
$$1, 2, 3, 4, 5, 6 ... 2n \notag$$

经过一轮后存活$n$个人:
$$1, 3, 5 ... 2n-1\notag$$

也就是说:
$$J(2n) = 2J(n) - 1 \notag$$

现在考虑$2n+1$的情况:
$$1, 2, 3, 4, 5, 6 ... 2n+1 \notag$$

经过一轮后还有n+1个人,为了方便,我们再把原来的1号杀掉:
$$3, 5, 7, 9... 2n+1 \notag$$

可以发现:
$$J(2n+1) = 2J(n) + 1 \notag$$

我们有:
\begin{equation}
\begin{cases}
J(1) &= 1\\
J(2n)&= 2J(n) - 1 ,n \ge 1 \\
J(2n+1) &= 2J(n) + 1 ,n \ge 1 
\end{cases}
\end{equation}

我们给出相关的值(#仅仅是为了补全空格):

| $n$  | 1 |\2. 2  3 |\4. 4  5  6  7 |\8. 8  9  10  11  12  13  14  15 | 16 |
|$J(n)$| 1 |\2. 1  3 |\4. 1  3  5  7 |\8. 1  3  #5  #7  #9  11  13  15 | #1 |

我们可以看出,将$n$写成$2^m+l$的形式, $J(n) = J(2^m+l) = 2l + 1$

使用数学归纳法证明其正确性.

当$n=2$时, $J(2) = 2J(1) - 1 = 1$成立, 设$n \lt 2^m + 1$是成立
* $2^m+l$ 为偶数时

显然$l$为偶数, $J(2^m+l) = 2J(2^{m-1} + { l \over 2}) - 1 = 2(2 \cdot {l \over 2} + 1) - 1 = 2l + 1$ 成立.

* $2^m+l$ 为奇数

显然$l$为奇数, $J(2^m+l) = J(2^m + l - 1 + 1) = 2J(2^{m-1} + {l - 1 \over 2 } + 1) = 2(2\cdot { l - 1 \over 2} + 1) + 1 = 2l + 1$ 成立.

令$n=\left(b_mb_{m-1}\cdots b_1b_0\right)_ 2$ 那么$l=\left(0b_{m-1}\cdots b_1b_0\right)_ 2$

\begin{equation}
\begin{split}
    J(\left(b_mb_{m-1}\cdots b_2b_0\right)_ 2) &= 2\left(0b_{m-1}\cdots b_1b_0\right)_ 2 + 1\\
            &= \left(0b_{m-1}\cdots b_1b_0\right)_ 2 \ll 1 + 1 \\
            &= \left(b_{m-1}\cdots b_1b_01\right)_ 2 \\
            &= \left(b_{m-1}\cdots b_1b_0b_m\right)_2
\end{split}
\end{equation}

这样我们就有快速求一个整数$n$,隔一个杀人的约瑟夫环问题,只要对其做一次二进制下的循环左移就可以了.
