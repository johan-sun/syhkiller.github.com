---
layout : article
title : 和式
category : 数学
tag : 
    - 具体数学
---

本次主要介绍和式的一些性质,以及扰动法.

h3. 和式的表示

使用$\sum_{p(k)}a_k$的形式表示和式更加方便,因为迭代变量k是可以运算的,比如$\sum_{k=1}^{n}a_k$用$k+1$代替$k$,则原式应为$$\sum_{k=2}^{n-1}a_{k+1}\notag$$不太明了,用全部下标方式表示就是$$\sum_{1 \le k + 1\le n}a_{k+1} \notag$$

和式还有另外一种布尔运算的表示形式
$$ \sum_{p(k)}a_k = \sum_k a_k\left [ p(k) \right ] \notag $$

其中$\left[ p(k) \right ]$表示$p(k)$为真时$\left [ p(k) \right ]$值为1,否则为0.

h2. 和式与递归式

h3. 和式转化为递归式

和式$S_n = \sum_{k=0}^n a_k$可以写成递归式如下

$$
\begin{split}
S_0 &= a_0 \\
S_n &= S_{n-1} + a_n 
\end{split}
$$

可以利用一下递归式进行和式求解:
\begin{equation}
\begin{split}
R_0 &= \alpha \\
R_n &= R_{n-1} + \beta n + \gamma  &, n \gt 0
\end{split} \label{eq1}
\end{equation}

设
$$R_n = A(n)\alpha + B(n)\beta + C(n)\gamma \label{eqrn} $$

令$R_n = 1$有
$$
\begin{split}
R_0 &= \alpha &= 1 \\
R_n &= R_{n-1} + \beta n + \gamma \\
    &= \beta n + 1 + \gamma + 1 &= 1
\end{split} \label{eqR1}
$$
由上式待定系数得到$\alpha = 1, \beta = \gamma = 0$带入$\ref{eqrn}$中得到
$$A(n) = 1 \label{eqan} $$

令$R_n = n$, 有
$$
\begin{split}
R_0 &= \alpha &= 0 \\
R_n &= R_{n-1} + \beta n + \gamma \\
    &= (\beta + 1)n + \gamma - 1 &= n
\end{split}
$$
由上式待定系数得$\alpha = 0, \beta = 0, \gamma = 1$,带入$\ref{eqrn}$得到
$$ C_n = n \label{eqbc1} $$

令$R_n = n^2$,有
$$
\begin{split}
R_0 &= \alpha &= 0\\
R_n &= R_{n-1} + \beta n + \gamma \\
    &= (n-1)^2 + \beta n + \gamma \\
    &= n^2 + (-2+\beta)n + 1 + \gamma &= n^2
\end{split}
$$
由上式待定系数得到$\alpha = 0, \beta = 2, \gamma = -1$,带入$\ref{eqrn}$得到
$$
2B(n) - C(n) = n^2 \label{eqbc2}
$$

由$\ref{eqan}, \ref{eqbc1}, \ref{eqbc2}$解方程得
$$
\begin{split}
A_n &= 1\\
B_n &= {n^2 + n \over 2}\\
C_n &= n
\end{split}
$$
带入$\ref{eqrn}$就获得了$\ref{eq1}$形式的通解
$$R_n = {n(n+1) \over 2} \beta + n\gamma + \alpha$$

这里做一个 *总结*: *诸如上式,如果递归式最高项的次数是$i$,我们就尝试$R_n = cn^{i+1}$进行待定系数* 这样 *可能* 能够方便得求出待定系数.

h3. 递归式转化为和式

若递归式形式为
$$
a_nT_n = b_nT_{n-1} + c_n \label{eqr}
$$
我们想办法将其转换为一个和式，思想就是两边乘以一个 _求和因子_ $s_n$
$$
s_na_nT_n = s_nb_nT_{n-1} + s_nc_n
$$
我们的目标是将上式写成$S_n = S_{n-1} + \delta_n$的形式，那么需要有
$$
s_nb_n = s_{n-1}a_{n-1} \label{eq2}
$$

那么记$S_n = s_na_nT_n$，递归式可以写成
$$
S_n = S_{n-1} + s_nc_n
$$
从而有
$$
S_n = s_0a_0T_0 + \sum_{k=1}^ns_kc_k = s_1b_1T_0 + \sum_{k=1}^ns_kc_k
$$
从而$\ref{eqr}$的解为
$$
T_n = {1\over s_na_n}\left( s_1b_1T_0 + \sum_{k-1}^ns_kc_k \right)
$$

其中$\ref{eq2}$的等式可以写成
\begin{equation}
\begin{split}
s_n &= {s_{n-1}a_{n-1}\over b_n}\\
	&= {s_{n-2}a_{n-2}a_{n-1} \over b_nb_{n-1}}\\
	&\vdots \\
	&= {s_1a_1a_2\cdots a_{n-1} \over b_2b_3\cdots b_n}
\end{split}
\end{equation}
取$s_1$为1即可。

h3. 扰动法

扰动法的基础是将和式中的一项分离出去,思想是从一个未知的和式开始,记为$S_n$:
$$S_n = \sum_{0 \le k \le n} a_k$$
对于最后一项和第一项将其分离出来,重新改写$S_{n+1}$：
\begin{equation}
\begin{split}
S_n + a_{n+1} &= \sum_{0 \le k \le n+1} a_k \\
	&= a_0 + \sum_{ 1 \le k \le n+1} a_k\\
	&= a_0 + \sum_{1 \le k+1 \le n+1}a_{k+1}\\
	&= a_0 + \sum_{0 \le k \le n}a_{k+1}
\end{split}
\end{equation}
我们将最后一项$\sum_{0 \le k \le n}a_{k+1}$ 尝试用$S_n$ 表示出来那么就可以得到$S_n$的闭形式。

例如求_几何级数_的和：
$$S_n = \sum_{0 \le k \le n}ax^k$$
利用扰动法的格式：
\begin{equation}
\begin{split}
S_n + ax^{n+1} &= ax^0 + \sum_{0 \le k \le n}ax^{k+1}\\
		&= ax^0 + a\sum_{0 \le k \le n}ax^k\\
		&= ax^0 + xS_n \label{eqge}
\end{split}
\end{equation}
式$\ref{eqge}$可以很快求得$S_n = {a-ax^{n+1} \over 1-x}, x \ne 1$ 

再求一个例子：$S_n = \sum_{0 \le k \le n}k2^k$
\begin{equation}
\begin{split}
S_n + (n+1)2^{n+1} &= 0 + \sum_{0 \le k \le n}(k+1)2^{k+1} \\
		&= \sum_{0 \le k \le n}k2^{k+1} + \sum_{0 \le k \le n}2^{k+1} \\
		&= 2\sum_{0 \le k \le n}k2^k + 2\sum_{0 \le k \le n}2^k \\
		&= 2S_n + 2\sum_{0 \le k \le n}2^k \\
		&= 2S_n + 2^{n+2} - 2
\end{split}
\end{equation}
求得$S_n = (n-1)2^{n+1} + 2$

对于$S_n = \sum_{0 \le k \le n} x^k = {1-x^{n+1} \over 1-x}$我们对其两边求导有：
\begin{equation}
\sum_{0 \le k \le n}kx^{k-1} = {1-x^{n+1} + (n+1)x^n \over (1-x)^2} , x \ne 1
\end{equation}
等式两边乘以$x$我们就得到了$\sum_{0 \le k \le n}kx^k$的结果为：
$$\sum_{0\le k \le n} = {x - (n+1)x^{n+1} - x^{n+2} \over (1-x)^2}$$
如果使用扰动法，结果相同。
